(in-package :goal-lib)

;; ==============================================================================;;;;
;; CONSTANTS
;; ==============================================================================;;;;

(defconstant else t)
(defun null? (val) (null val))
(defun integer? (val) (integerp val))
(defun float? (val) (floatp val))

(defconstant true t)
(defconstant false nil)

(defmacro equal? (&rest args)
  `(equalp ,@args))

(defmacro notequal? (&rest args)
  `(not (equalp ,@args)))

(defmacro == (&rest args)
  `(equalp ,@args))

(defmacro != (&rest args)
  `(not (equalp ,@args)))

;; ==============================================================================;;;
;;
;; ==============================================================================;;;;

(cl:defmacro ex/defconstant (&whole whole
                          name initial-value &optional documentation)
  (declare (ignore initial-value documentation))
  `(progn
     (export ',name)
     (cl:defconstant ,name ,@(cddr whole))))

(cl:defmacro ex/defmacro (name lambda-list &body body)
  `(progn
     (export ',name)
     (defmacro ,name ,lambda-list ,@body)))


(cl:defmacro ex/defun (name lambda-list &body body)
  `(progn
     (export ',name)
     (defun ,name ,lambda-list ,@body)))

;; ==============================================================================;;;;
;; STRING TOOLS
;; ==============================================================================;;;;

(defun string-append (&rest list)
  (format nil "狺蝈盹鲥铋扉篝┅ㄤ彐磲泸篝蜷铉狃疱钿鲠蝈篝扉篝啜箦翩鲠ㄦ矧磲铋狺蝈盹鲥铋扉篝鲠漓轶舂┅┅ㄤ彐躅篝蜷铉觑轭扉篝镳糸镱犰ㄤ屐轫Β┅鏖翳秕麴豸麸篝蜷铉螬麒孱扉篝ㄦ矧磲立ㄦ轵篝扉篝┅ㄤ镬轶ㄥ戾礤铘蝈篝扉篝┅ㄦ矧磲窿立溴扉屐屙孱舂┅┅ㄤ彐躅扉篝倔趄轭祗舂ㄦ矧磲铋窿祗舂ㄤ彐躅篝蜷铉篚怏趄轭铄邃戾栳篝徙脲翦篝с栳蚪┅⒁弭躜铙翳轭溴镦翳骈蝮镢沲蝌孱沐镦翳篝蜷铉溴箝珙狒邃怡闻拍膛鏖翳轭翳篝蜷铉溴箝珙狒邃怡攘儆粤盟矧紊殒轸滹弩铒镢沲虍描狎徙翦蝮鏖翳轭翳篝蜷铉狎泔眇狎邃怡耘釉麒殂溴驷蹯趔麸萌烈ㄦ矧汜箦箦铙轸轹泔眇狎轶镱┊箦狎汨篝蜷铉铄邃戾篝蜷铉栳篝徙氅呼弩翦篝┅ㄤ彐躅篝蜷铉麸镱瀛扉铄螬ㄣ飙痧泸搴蝈珏蝈痨徙瀛犰ㄜ茴苘螵ぉ┅换换换换换换换换换换歪翳歪泸矬换换换换换换换换换ㄤ彐磲泸箦簟痨徙鲠祯濠啜箦翩痨徙鲠祯濠换ㄤ彐磲泸鲍鲠颟换啜鲠暴换ㄤ彐磲泸轭鲠飑⑸钽蝈礤铘鲠祯澧啜鲍鲠飑ㄤ彐磲泸痨徙犴秕铘啜箦簟痨徙ǐ痨徙犴秕铘┅ㄤ彐磲泸鲍痨徙濠啜痨徙暴换ㄤ彐磲泸杯鲠颟换啜鲠暴换ㄤ彐磲泸溴鲠飑⒛邈蝈礤铘鲠祯澧啜杯鲠飑ㄤ彐磲泸痨徙犴秕铘啜箦簟痨徙ō痨徙犴秕铘┅ㄤ彐磲泸杯痨徙濠啜痨徙暴ㄤ彐磲泸痨徙犴秕铘啜箦簟痨徙í痨徙犴秕铘┅ㄤ彐磲泸痨徙犴秕铘啜箦簟痨徙ǒ痨徙犴秕铘┅ㄤ彐磲泸弪锟翳轭绌啜羼翳轭癌ㄤ彐磲泸铒铤弪锟翳轭绌啜铄窨翳轭癌ㄤ彐磲泸矧痨徙蝈篝狎珞啜箦簟痨徙矧痨徙泪蜱螬ㄤ彐磲泸铒簟鲠颟啜箦簟鲠铒鲠颟┅ㄤ彐磲泸趄蹂鲠颟啜箦簟鲠趄蹂┅ㄤ彐磲泸驷祗濉鲠颟啜箦簟鲠驷祗濠ㄤ彐磲泸黹铐狲鲠黹铞犰磲鲠飑啜磲黹鲠磲鲠飑黹铞犰ㄤ彐磲泸骓轭磲鲠黹铞犰磲鲠飑啜骓狲ㄦ黹鲠磲鲠飑黹铞犰ㄤ彐磲泸黹铐狲鲠黹铞犰磲鲠飑啜箦簟鲠磲黹鲠磲鲠飑黹铞犰┅ㄤ彐磲泸骓轭磲鲠黹铞犰磲鲠飑啜箦簟鲠ㄦ磲ㄦ黹鲠磲鲠飑黹铞犰┅ㄤ彐磲泸磲黹鲠黹铞犰磲鲠飑啜黹磲鲠磲鲠飑黹铞犰ㄤ彐磲泸骓狲黹鲠黹铞犰磲鲠飑啜骓轭ㄦ磲鲠磲鲠飑黹铞犰ㄤ彐磲泸Λ鲠犴秕铘啜箦簟鲠é鲠犴秕铘┅ㄤ彐磲泸Νㄡ猢啜翳瀛狍轭岍翳瀛狍轭猢ㄤ彐磲泸Νé蝈篝狎珞啜ō泪蜱螬ㄤ彐磲泸祜玳矧痨徙犴秕铘啜箦簟痨徙祜玳矧痨徙犴秕铘┅ㄤ彐磲泸祜瑛矧痨徙犴秕铘啜箦簟痨徙祜瑛矧痨徙犴秕铘┅ㄤ彐磲泸祜玑钿痨徙犴秕铘啜箦簟痨徙祜玑钿痨徙犴秕铘┅ㄤ彐磲泸祜玢戾狎ㄡ猢⒁弭躜铙翳蝈篚祠镦箦趑轭翳忾趔轭麸弪轭幄换瘐骈蝮箫翳蝈趱蝾豉疱磲翥桢岙啜祜玑钿祜珙雉猢ㄤ彐磲泸祜玢戾狎ㄡ猢⒂弭翳忾趔轭麸弪轭岈轭痨徙澧啜箦簟祜玑钿祜珙雉猢┅ㄤ彐磲泸祜玺弩艨ㄡ猢滹弩栳鲥犷镦翳忾趔轭饪啜铒铤弪锟祜玑钿猢ㄤ彐磲泸祜玺弩翎ㄡ猢滹弩栳鲥撂镦翳忾趔轭饪啜祜玑钿岍猢｜ㄤ彐磲泸溴蝈徜潋蝈篝骈屐潴啜翳瀛狍痫轭翦舂徜潋梨殄熹螬ㄤ彐磲泸溴蝈徜潋蝈篝骈屐潴啜Ν翳瀛狍痫轭翦舂徜潋梨殄熹螬ㄤ彐磲泸箬殒舡狎轸璀蜷玷舡巢蝈篚祠轭筢啜箦簟蝈篚祠箦舫筢祜玑钿ｘ骀骀骀骀翳瀛狍轭轭┅筢┅ㄤ彐磲泸碍珲狎ㄡ猢Ⅲ犴狍溟鲩溴怩蝈趱蝾麒孱溟鲩箫轶弪ㄅ怒扉脲┊啜戾è溟鲩箫猢ㄩ弪锟溟鲩箫颟ǒ溟鲩箫颟ㄤ彐磲泸盹洵碍珲狎ㄡ猢Ⅲ犴狍盹漉祜怩蝈趱蝾翳溟鲩溴钿麒孱溟鲩箫轶弪ㄅ怒扉脲┊啜戾è溟鲩箫猢ㄩ弪锟溟鲩箫颟盹溟鲩箫颟ㄤ彐磲泸骒镝舡鹃铘ㄡ㈡矧沐骢祆汜篝箫礤翳轭狍骒镝麸轭舢忮汜蝈骢飚啜翳轭翦珏蝻躅翳骒镝岍┅换浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇换麻歪泸矬换浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇ㄤ彐磲泸犰殓瞽鲠瞟⑨扉珙鲠麸瞽怡翦怙躅溽蜷弩啜祜玑钿ō瞟ǐ翳瀛狍轭鲠飑ō暴┅ㄤ彐磲泸犰殓畋鲠飑啜犰殓瞽鲠倍ㄤ彐磲泸犰殓疃鲠飑啜犰殓瞽鲠洞ㄤ彐磲泸忾舡骈屐鲠忉箦箝镳糸镱犰箝珙邃舂㈠趄徙忾趔骝镯犷轭翦珏鲠祯瀹麒孱ㄡ钿ㄩ铘彗弪忉箦ㄩ铘彗弪箝濠麒孱ǐ忉箦箝濠洞ㄥ蝌矧汜铑雉屮趄徙骈屐潴徙蝻篌洞忾怙躅溽蜷弩┅麒孱忉箦癌ㄥ蝌矧⑩轸骈屐忉箦汜铑雉忮铄玑糸鲥┅麒孱箝癌ㄥ蝌矧⑩轸骈屐箝汜铑雉忮铄玑糸鲥┅啜ㄩ箝珙邃筢箬颟箬鲠ō洞ǐ箝忉箦┅ō洞箝濠换浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇换换换躺釉换浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇换换ㄤ彐磲泸扉篝蝈扉篝瞟啜铘扉篝┅ㄤ彐躅扉篝决邈麸扉篝ㄣ镥蜚扉篝鲥泗矧┅ㄤ彐躅鲥泗矧眷轶ㄡ蝌狴ㄣ镥蜚狎蜥ъ轶舂ㄤ彐磲泸狃疱钿扉篝雯啜箦翩扉篝ㄡ痧孱扉篝ㄣ镱铋飑┅换浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇换换换烈伊儆换浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇换换ㄤ彐躅狎颦铄é脲ㄣ狃徙轸俯ㄥ戾礤铘豉疱铋飑ㄩ屐屙孱舡豉疱磲脲狎蜥汜疳汩豉烘殪飙痫轭翦横潢躞翎忪哄戾礤铘豉疱屐屙孱舡豉疱磲脲狎蜥汜疳汩豉烘殪飙痫轭翦横潢躞翎忪舂┅ㄤ彐磲泸狎颦骈蝮ㄣ镬飑⒁弭躜铙翳骈蝮屐屙孱轭犷狎蜥啜狎彐泔祆癌ㄤ彐磲泸狎颦灬篝ㄣ镬飑⒁弭躜铙翳灬篝屐屙孱轭犷狎蜥啜狎彐泔祆ㄤ邈戾铉翳泔祆┅┅ㄤ彐磲泸狎颦灬篝殇ㄣ镬飑⒁弭躜铙翳轭溴镦翳灬篝屐屙孱轭犷狎蜥啜溴戾铉翳泔祆┅ㄤ彐磲泸狎颦殇镦ㄣ镬鲠溴姗⒁弭躜铙翳轭溴镦犷轸屙轭犷狎蜥蝈趱蝾间彐殒轶铒翳轭轶骘躅洚啜忪镢骈钿屐屙孱ㄤ雉轫弩ㄩ戾铉翳泔祆┅ㄩ鲠ō泔祆椹蝈趱蝾骝镯骈钿屐屙孱椹┅溴姗ㄤ彐磲泸狎颦蝈ㄣ镬殇镳糸镱犰ㄤ彐狨祠铋飑啜泔钿è殇癌溴驷蹯舂è窘殇戾铉翳泔飑溴驷蹯舂ㄡ蝈泔殇┅┅ㄤ彐磲泸狎颦箦簟ㄣ镬殇鲠飑啜箦翩ㄡ蝈泔殇鲠飑ㄤ彐磲泸狎颦瘐箬ㄣ镬鲠飑啜鲥泗矧瘐箬鲠泔飑ㄤ彐磲泸狎颦泔躅ㄣ镬啜戾铉翳泔飑换浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇换柔箬翎忪桢祓翦蝮换浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇ㄤ彐磲泸栳箬蝈ㄨ狍脲镳糸镱犰ㄤ彐狨祠铋飑啜珏翳狍脲栳箬溴驷蹯舂ㄤ彐磲泸栳箬箦簟ㄨ狍脲鲠飑啜箦翩ㄧ弭栳箬脲栳箬鲠飑ㄤ彐磲泸栳箬泔躅ㄨ狍瑭啜栳箬翎忪瀛泔躅栳箬┅ㄤ彐磲泸栳箬磲ㄨ狍骢钽啜磲痂狍＇骢钽栳箬┅ㄤ彐磲泸栳箬沆遽颉ㄨ狍瑭啜沆蜩狍栳箬┅ㄤ彐躅磲脲栳箬é脲ㄣ狃徙轸俯磲脲栳箬翎忪后辁汜疳汩豉┅换浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇换澡篝蝓泗躜桢祓弪换浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇换俞礤狍鏖翳箪雉怩汜蝈钺礤骈屐潴戾篌鲥蜮矬换换阵徵搴换换ㄤ彐篝蝓泗龀换ㄤ彐鲠磲脲龀壶卑葫舶胡嘲┅换睐鏖翳箪雉姝龀换ㄦ矧磲幄姝姝姝┅换换ㄤ彐躅骘ī换睐鏖翳箪雉骘锃龀磲脲龀壶卑葫舶胡嘲换睐鏖翳箪雉忉颦龀磲脲龀壶窗葫蛋胡栋换ㄦ矧磲⑵舷狺ア骘锃骘锃骘锃换ㄦ矧磲⒙烈狺ア忉颦忉颦忉颦┅┅换ㄦ镲ㄤ彐磲泸睐鏖翳箪雉痱彐轼篝蝓泗蝈篝骈屐潴镡怙澌怙澌ㄡ篌弪篝蝓泗韵南腴祆翳疳蜥礤翦釉艺迷戾舄换磲脲屙痿痱彐轼骘铋è疰ㄩ铛祆痱彐轼痱彐轼┅换磲脲扉篝镦骈屐潴犷徙沐篌矧簌礅镬扉篝祜镳骘骈屐洵钺礤轭骈屐潴泔祆邈ㄣ镱换祜汜鲠蜷徕戾钺礤ㄩ铘弪ㄦ矧磲铋狺幄疰骈屐洵钺礤┅换箪雉钺礤骈屐洵钺礤┅ㄥ痱扉篝祜镳骘轭簌礅镬扉篝泔祆邈啜ㄣ狎姗箪雉鲠祯镡Кㄣ潋姗┅┅啜戾ì厘痱扉篝棱镤┅换蔑瘗翳篝蝓泗躜犷秭弪蜷溴箫礤镦鲠祯弩换换锰沼乓ㄤ彐篝蝓泗骘忉忉换葡换锰沼乓ㄤ彐疳蜥礤翦骈蝮舄磲脲骘衡狎畅换粕矣元换锰沼乓ㄤ彐疳蜥礤翦箦泔钿躔溽翦篝蝓泗骈蝮舄р狷博换优孟文换锰沼乓鲠祯弩骈蝮舄箦泔钿换Ｓㄆ舷郝烈郝邻紊泰换Ｓㄆ舷郝烈郝邻博ㄤ彐躅躔溽翦篝蝓泗篝蝓泗蝈篝忾钿轭珞祜镳鏖翳泔瘗ㄣ镳篝蝓泗躜篝蝓泗骘箪雉鲠祯濠镱忾钿轭珞怡＇沅潋滹戾è箪雉钺礤ㄦ轭洵簌礅镬簌礅镬钺礤箪雉┅┅箦翩箪雉鲠祯泔瘗箪雉钺礤鲠祯濠骈钺祆蝈趱蝾泔瘗┅换浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇换换浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇换睐溴骢骘ㄡ猢换鲠博换鲠畅换í猢换换ㄦ镲旦换骄辈ㄤ彐躅睐鲠蜾邈飙⒁弭躜趄蹂殒轶ㄖ烈瘟团至陶农骘蝽ㄡ钿扉篝戾铉翳暴ㄥ鲠ㄣ狎┅┅ㄤ彐磲泸睐溴骢钺礤狎珞蝈篝怙澌⒂疱汩犰骘蝽镦呐普鏖翳骒狒翦骘蝽狒骘膛鲠蝮戾è鲠蜾邈祗磲疸狎＇沅蝈盹鲥殒铒＇睐鲠蜾邈飙怙澌┅蝈犰怙澌蝈盹鲥殒＇睐鲠蜾邈飙怙澌┅啜溴骢钺礤狎珞戾舄鲠蜾邈祗莉遽焘镤┅┅换浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇换郁蝓泗躜麸扉篝犷忉汶换浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇ㄤ彐躅篝蝓泗溟蝈泗钺礤篝蝓泗祜镳骘箪轭筲盹鸷恒灬篌溟蝈泗箪雉ㄣ灬篌镦篝蝓泗┅泔祆邈扉篝筲盹鸷箪雉溴骈铋糸镱钺礤箪箪雉鲠祯箪筲疸旌洪铘弪钺飙蝈徜弪骢钽糸镱┅┅ㄤ彐躅篝蝓泗溟蝈泗鲠祯弩篝蝓泗ㄣ镱豉疱镦篝蝓泗祜镳骘铕轭篝蝓泗溟蝈泗钺礤篝蝓泗泔祆邈ㄣ镱ㄣ狎铕ㄦ躅汜祆ㄣ徜铕篝蝓泗┅┅ㄤ彐躅篝蝓泗钺礤篝蝓泗祜镳骘箪轭筲盹鸷恒灬篌箪雉ㄣ灬篌镦篝蝓泗┅泔祆邈扉篝筲盹鸷箪雉溴骈铋糸镱钺礤箪箪雉鲠祯箪筲疸旌洪铘弪钺飙蝈徜弪骢钽糸镱┅┅ㄤ彐躅篝蝓泗鲠祯弩篝蝓泗ㄣ镱豉疱镦篝蝓泗祜镳骘铕轭篝蝓泗钺礤篝蝓泗泔祆邈ㄣ镱ㄣ狎铕ㄦ躅汜祆ㄣ徜铕篝蝓泗┅┅ㄤ彐躅篝蝓泗鲠飑豉疱鲠篝蝓泗躜瀛镡赍泗┅ㄤ彐躅篝蝓泗麸扉篝鲠飑ㄣ镱è豉疱鲠ц狍璀翎忪濠鲠飑è豉疱鲠鲥泗矧鲠飑è篝蝓泗鲠飑祜镳骘轭篝蝓泗鲠祯弩鲠飑泔祆邈篝蝓泗麸扉篝雯┅è泔铙鲠飑ㄣ镱篝蝓泗麸扉篝ㄣ狎鲠飑篝蝓泗麸扉篝ㄣ潋鲠飑┅ㄔ鲠飑┅ㄤ彐躅扉篝麸篝蝓泗ㄤ篝篁悱犰篝戾è鲠飙犰篝篝蝓泗麸扉篝潴舂┅祜镳骘轭ㄣ潋鲠飙犰篝骘轭ㄣ潋篁悱犰篝滹箦翩箪雉鲠祯潴ㄣ狎洎ㄣ潋螬┅┅ㄤ彐躅扉篝麸篝蝓泗ㄤ篝篁悱犰篝戾è泔瘗ㄣ镳篝蝓泗躜潴舂┅扉篝麸篝蝓泗泔瘗篁悱犰篝泔瘗┅换ㄤ彐篝蝓泗骘换ㄤ彐篝蝓泗忉换ㄤ彐疳蜥礤翦颦骘壶暴换ㄤ彐疳蜥礤翦磲脲忉挫轶舡麸┅换ㄤ彐疳蜥礤翦篝蝓泗麸扉篝┅ㄤ彐躅泔瘗疳蝈铘篝蝓泗骢钽痣潴篁蝈篝忾钿轭珞⒚镳篁篝蝓泗躜麸潴篝蜥泗躜犷躞徜溟糸镱犰忾钿轭珞扉篝麸篝蝓泗潴篝蝓泗麸扉篝篁悌祜镳骘箪雉鲠祯濠镱忾钿轭珞怡＇沅潋滹箦翩箪雉鲠祯潴ㄦ轭洵簌礅镬簌礅镬钺礤箪雉痣绌鲠祯濠骈钺祆蝈趱蝾潴舂┅ㄤ彐磲泸泔瘗疳蝈铘篝蝓泗ㄤ篝篁蝈篝忾钿轭珞⒚镳篁篝蝓泗躜麸潴篝蜥泗躜犷躞徜溟糸镱犰忾钿轭珞啜泔瘗疳蝈铘篝蝓泗骢钽疳汶徵濯潴篁棱轭溟铉螬花溴骟趄蹉忉花溴骣狎忉磲脲忉壶葫胡畅花溴骣狎忉磲脲忉壶葫胡订花痱轭ㄣ镳疳蝈铘篝蝓泗忉忉壶卑癌