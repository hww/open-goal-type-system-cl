(in-package :goal-lib)


;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; CONSTANTS
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(defconstant else t)
(defun null? (val) (null val))
(defun integer? (val) (integerp val))
(defun float? (val) (floatp val))

(defconstant true t)
(defconstant false nil)

(defmacro equal? (&rest args)
  `(equalp ,@args))

(defmacro notequal? (&rest args)
  `(not (equalp ,@args)))

(defmacro == (&rest args)
  `(equalp ,@args))

(defmacro != (&rest args)
  `(not (equalp ,@args)))


;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; STRING TOOLS
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(defmacro string-append (&rest list)
  `(format nil "狺扉篝漓轶舂┅ㄤ彐磲泸篝蜷铉狃疱钿鲠蝈篝扉篝啜箦翩鲠篝蜷铉狃疱钿鲠漓轶舂┅ㄤ彐躅篝蜷铉觑轭扉篝镳糸镱犰ㄤ屐轫Β┅鏖翳秕麴豸麸篝蜷铉螬麒孱扉篝ㄦ矧磲立ㄦ轵篝扉篝┅ㄤ镬轶ㄥ戾礤铘蝈篝扉篝┅ㄦ矧磲窿立溴扉屐屙孱舂┅┅换换换换换换换换换换换换换换换换躺釉换换换换换换换换换换换换换换换ㄤ彐磲泸扉篝蝈扉篝瞟啜铘扉篝┅ㄤ彐躅扉篝踞蝌狴扉篝ㄣ镥蜚扉篝鲥泗矧┅ㄤ彐躅狎蜥眷轶ㄡ蝌狴ㄣ镥蜚狎蜥ъ轶舂换换换换换换换换换换换换换换换换烈伊儆换换换换换换换换换换换换换换换ㄤ彐躅狎颦铄é脲ㄣ狃徙轸俯ㄥ戾礤铘豉疱铋飑ㄩ屐屙孱舡豉疱磲脲狎蜥汜疳汩豉烘殪飙痫轭翦横潢躞翎忪哄戾礤铘豉疱屐屙孱舡豉疱磲脲狎蜥汜疳汩豉烘殪飙痫轭翦横潢躞翎忪舂┅ㄤ彐磲泸狎颦骈蝮ㄣ镬飑⒁弭躜铙翳骈蝮屐屙孱轭犷狎蜥啜狎彐泔祆癌ㄤ彐磲泸狎颦灬篝ㄣ镬飑⒁弭躜铙翳灬篝屐屙孱轭犷狎蜥啜狎彐泔祆ㄤ邈戾铉翳泔祆┅┅ㄤ彐磲泸狎颦灬篝殇ㄣ镬飑⒁弭躜铙翳轭溴镦翳灬篝屐屙孱轭犷狎蜥啜溴戾铉翳泔祆┅ㄤ彐磲泸狎颦殇镦ㄣ镬鲠溴姗⒁弭躜铙翳轭溴镦犷轸屙轭犷狎蜥蝈趱蝾间彐殒轶铒翳轭轶骘躅洚啜忪镢骈钿屐屙孱ㄤ雉轫弩ㄩ戾铉翳泔祆┅ㄩ鲠ō泔祆椹蝈趱蝾骝镯骈钿屐屙孱椹┅溴姗ㄤ彐磲泸狎颦蝈ㄣ镬脲镳糸镱犰ㄤ彐狨祠铋飑啜狎彐泔殇┅ㄤ彐磲泸狎颦箦簟ㄣ镬殇鲠飑啜箦翩ㄡ蝈泔殇鲠飑ㄤ彐磲泸狎颦瘐箬ㄣ镬鲠飑啜鲥泗矧瘐箬泔鲠飑ㄤ彐磲泸狎颦泔躅ㄣ镬啜戾铉翳泔飑换换换换换换换换换换歪翳歪泸矬换换换换换换换换换ㄤ彐磲泸箦簟痨徙鲠祯濠啜箦翩痨徙鲠祯濠换ㄤ彐磲泸鲍鲠颟换啜鲠暴换ㄤ彐磲泸轭鲠飑⑸钽蝈礤铘鲠祯澧啜鲍鲠飑ㄤ彐磲泸痨徙犴秕铘啜箦簟痨徙ǐ痨徙犴秕铘┅ㄤ彐磲泸鲍痨徙濠啜痨徙暴换ㄤ彐磲泸杯鲠颟换啜鲠暴换ㄤ彐磲泸溴鲠飑⒛邈蝈礤铘鲠祯澧啜杯鲠飑ㄤ彐磲泸痨徙犴秕铘啜箦簟痨徙ō痨徙犴秕铘┅ㄤ彐磲泸杯痨徙濠啜痨徙暴ㄤ彐磲泸痨徙犴秕铘啜箦簟痨徙í痨徙犴秕铘┅ㄤ彐磲泸痨徙犴秕铘啜箦簟痨徙ǒ痨徙犴秕铘┅ㄤ彐磲泸弪锟翳轭绌啜羼翳轭癌ㄤ彐磲泸铒铤弪锟翳轭绌啜铄窨翳轭癌ㄤ彐磲泸矧痨徙蝈篝狎珞啜箦簟痨徙矧痨徙泪蜱螬ㄤ彐磲泸铒簟鲠颟啜箦簟鲠铒鲠颟┅ㄤ彐磲泸趄蹂鲠颟啜箦簟鲠趄蹂┅ㄤ彐磲泸驷祗濉鲠颟啜箦簟鲠驷祗濠ㄤ彐磲泸黹铐狲鲠黹铞犰磲鲠飑啜磲黹鲠磲鲠飑黹铞犰ㄤ彐磲泸骓轭磲鲠黹铞犰磲鲠飑啜骓狲ㄦ黹鲠磲鲠飑黹铞犰ㄤ彐磲泸黹铐狲鲠黹铞犰磲鲠飑啜箦簟鲠磲黹鲠磲鲠飑黹铞犰┅ㄤ彐磲泸骓轭磲鲠黹铞犰磲鲠飑啜箦簟鲠ㄦ磲ㄦ黹鲠磲鲠飑黹铞犰┅ㄤ彐磲泸磲黹鲠黹铞犰磲鲠飑啜黹磲鲠磲鲠飑黹铞犰ㄤ彐磲泸骓狲黹鲠黹铞犰磲鲠飑啜骓轭ㄦ磲鲠磲鲠飑黹铞犰ㄤ彐磲泸Λ鲠犴秕铘啜箦簟鲠é鲠犴秕铘┅ㄤ彐磲泸Νㄡ猢啜翳瀛狍轭岍翳瀛狍轭猢ㄤ彐磲泸Νé蝈篝狎珞啜ō泪蜱螬ㄤ彐磲泸祜玳矧痨徙犴秕铘啜箦簟痨徙祜玳矧痨徙犴秕铘┅ㄤ彐磲泸祜瑛矧痨徙犴秕铘啜箦簟痨徙祜瑛矧痨徙犴秕铘┅ㄤ彐磲泸祜玑钿痨徙犴秕铘啜箦簟痨徙祜玑钿痨徙犴秕铘┅ㄤ彐磲泸祜玢戾狎ㄡ猢⒁弭躜铙翳蝈篚祠镦箦趑轭翳忾趔轭麸弪轭幄换瘐骈蝮箫翳蝈趱蝾豉疱磲翥桢岙啜祜玑钿祜珙雉猢ㄤ彐磲泸祜玢戾狎ㄡ猢⒂弭翳忾趔轭麸弪轭岈轭痨徙澧啜箦簟祜玑钿祜珙雉猢┅ㄤ彐磲泸祜玺弩艨ㄡ猢滹弩栳鲥犷镦翳忾趔轭饪啜铒铤弪锟祜玑钿猢ㄤ彐磲泸祜玺弩翎ㄡ猢滹弩栳鲥撂镦翳忾趔轭饪啜祜玑钿岍猢｜ㄤ彐磲泸溴蝈徜潋蝈篝骈屐潴啜翳瀛狍痫轭翦舂徜潋梨殄熹螬ㄤ彐磲泸溴蝈徜潋蝈篝骈屐潴啜Ν翳瀛狍痫轭翦舂徜潋梨殄熹螬ㄤ彐磲泸箬殒舡狎轸璀蜷玷舡巢蝈篚祠轭筢啜箦簟蝈篚祠箦舫筢祜玑钿ｘ骀骀骀骀翳瀛狍轭轭┅筢┅ㄤ彐磲泸碍珲狎ㄡ猢Ⅲ犴狍溟鲩溴怩蝈趱蝾麒孱溟鲩箫轶弪ㄅ怒扉脲┊啜戾è溟鲩箫猢ㄩ弪锟溟鲩箫颟ǒ溟鲩箫颟ㄤ彐磲泸盹洵碍珲狎ㄡ猢Ⅲ犴狍盹漉祜怩蝈趱蝾翳溟鲩溴钿麒孱溟鲩箫轶弪ㄅ怒扉脲┊啜戾è溟鲩箫猢ㄩ弪锟溟鲩箫颟盹溟鲩箫颟ㄤ彐磲泸骒镝舡鹃铘ㄡ㈡矧沐骢祆汜篝箫礤翳轭狍骒镝麸轭舢忮汜蝈骢飚啜翳轭翦珏蝻躅翳骒镝岍┅换换换换换换换换换换换换换换麻歪泸矬换换换换换换换换换换换换换ㄤ彐磲泸犰殓瞽鲠瞟⑨扉珙鲠麸瞽怡翦怙躅溽蜷弩啜祜玑钿ō瞟ǐ翳瀛狍轭鲠飑ō暴┅ㄤ彐磲泸犰殓畋鲠飑啜犰殓瞽鲠倍ㄤ彐磲泸犰殓疃鲠飑啜犰殓瞽鲠洞ㄤ彐磲泸忾舡骈屐豉疱鲠忉箦箝镳糸镱犰箝珙邃舂㈠趄徙忾趔骝镯犷轭翦珏鲠祯瀹麒孱ㄡ钿ㄩ铘彗弪忉箦ㄩ铘彗弪箝濠麒孱ǐ忉箦箝濠洞ㄥ蝌矧汜铑雉屮趄徙骈屐潴徙蝻篌洞忾怙躅溽蜷弩┅麒孱忉箦癌ㄥ蝌矧⑩轸骈屐忉箦汜铑雉忮铄玑糸鲥┅麒孱箝癌ㄥ蝌矧⑩轸骈屐箝汜铑雉忮铄玑糸鲥┅啜ㄩ箝珙邃筢箬颟箬鲠ō洞ǐ箝忉箦┅ō洞箝濠换换换换换换换换换换换换换换澡篝蝓泗躜桢祓弪换换换换换换换换换换换换换换俞礤狍鏖翳箪雉怩汜蝈钺礤骈屐潴戾篌鲥蜮矬换换阵徵搴换换ㄤ彐篝蝓泗龀换ㄤ彐鲠磲脲龀壶卑葫舶胡嘲┅换睐鏖翳箪雉姝龀换ㄦ矧磲幄姝姝姝┅换换ㄤ彐躅骘ī换睐鏖翳箪雉骘锃龀磲脲龀壶卑葫舶胡嘲换睐鏖翳箪雉忉颦龀磲脲龀壶窗葫蛋胡栋换ㄦ矧磲⑵舷狺ア骘锃骘锃骘锃换ㄦ矧磲⒙烈狺ア忉颦忉颦忉颦┅┅换ㄦ镲ㄤ彐磲泸睐鏖翳箪雉痱彐轼篝蝓泗蝈篝骈屐潴镡怙澌怙澌戾舄è簌礅镬扉篝祜镳骘轭骈屐潴泔祆邈ㄣ镱ㄩ铘弪ㄦ矧磲铋狺幄痱彐轼姗ㄦ轭洵簌礅镬篝蜷铉躔汜箦ㄦ矧磲铋岘幄篝蝓泗姗┅┅ㄥ痱扉篝祜镳骘轭簌礅镬扉篝泔祆邈啜ㄣ狎姗ìㄣ潋姗镡戛┅┅啜簌礅镬磲泸镬弭ì厘痱扉篝棱镤┅换蔑瘗翳篝蝓泗躜犷秭弪蜷溴箫礤镦鲠祯弩换换锰沼乓ㄤ彐篝蝓泗骘忉忉换葡换锰沼乓ㄤ彐疳蜥礤翦骈蝮舄磲脲骘衡狎畅换粕矣元换锰沼乓ㄤ彐疳蜥礤翦箦泔钿躔溽翦篝蝓泗骈蝮舄р狷博换优孟文换锰沼乓鲠祯弩骈蝮舄箦泔钿换Ｓㄆ舷郝烈郝邻紊泰换Ｓㄆ舷郝烈郝邻博ㄤ彐躅躔溽翦篝蝓泗篝蝓泗蝈篝忾钿轭珞祜镳鏖翳泔瘗ㄣ镳篝蝓泗躜篝蝓泗骘箪雉鲠祯濠镱忾钿轭珞怡＇沅潋滹箦翩箪雉鲠祯泔瘗箪雉鲠祯濠骈钺祆蝈趱蝾泔瘗┅换浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇换柔箬翎忪桢祓翦蝮换浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇ㄤ彐磲泸栳箬蝈ㄨ狍脲镳糸镱犰ㄤ彐狨祠铋飑啜珏翳狍脲栳箬溴驷蹯舂ㄤ彐磲泸栳箬箦簟ㄨ狍脲鲠飑啜箦翩ㄧ弭栳箬脲栳箬鲠飑ㄤ彐磲泸栳箬泔躅ㄨ狍瑭啜栳箬翎忪瀛箝栳箬┅ㄤ彐磲泸栳箬磲ㄨ狍骢钽啜磲痂狍骢钽栳箬┅换浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇换换浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇浇换睐溴骢骘ㄡ猢换鲠博换鲠畅换í猢换换ㄦ镲旦换骄辈ㄤ彐躅睐鲠蜾邈飙⒁弭躜趄蹂殒轶ㄖ烈瘟团至陶农骘蝽ㄡ钿扉篝戾铉翳暴ㄥ鲠ㄣ狎┅┅ㄤ彐磲泸睐溴骢钺礤狎珞蝈篝怙澌⒂疱汩犰骘蝽镦呐普鏖翳骒狒翦骘蝽狒骘膛鲠蝮戾è鲠蜾邈祗磲疸狎＇沅蝈盹鲥殒铒＇睐鲠蜾邈飙怙澌┅蝈犰怙澌蝈盹鲥殒＇睐鲠蜾邈飙怙澌┅啜溴骢钺礤狎珞戾舄鲠蜾邈祗莉遽焘镤┅┅